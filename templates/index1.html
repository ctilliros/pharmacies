<html>
<head>
  <title>Demo Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1  maximum-scale=1">
  <link rel="stylesheet" media="screen" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap-theme.min.css"/>
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"/> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>

  <!-- (Optional) Latest compiled and minified JavaScript translation files -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/i18n/defaults-*.min.js"></script> -->



  <script>$SCRIPT_ROOT = {{request.script_root|tojson|safe}};</script>
  {% block style%}
  <style type="text/css">
    /* Remove arrows from input number text box */
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    
    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }
    /* ============================================= */    

  </style>  
  {% endblock %}

  {% block script%}

  <script type="text/javascript">    

    $(document).ready(function(){

      $("div.desc").hide();
      
      $(document).bind("contextmenu",function(e) {
       e.preventDefault();
     });
      $(document).keydown(function(e){
        if(e.which === 123){
         return false;
       }
     });
      $('form').on('submit', function(event){
        $.ajax({
          data:{            
            identification_method:$("#identification_method").val(),
            identification:$("#identification").val(),            
            password:$("#password").val()
          },
          type: 'POST',
          url:'/login',          
        })
        .done(function(data){                
          window.setTimeout(function(){
            var account  = $("#identification").val();            
            var method = $("#identification_method").val();
            // if (method ==='Ταυτότητα'){
            //   method == 'id';
            // }
            // if (method ==='Διαβατήριο'){
            //   method== 'passport';
            // }
            // if (method ==='Τηλέφωνο Επικοινωνίας'){
            //   method == 'contact';
            // }
            // if (method ==='Ηλεκτρονικό Ταχυδρομείο'){
            //   method=='email';
            // }
            alert("Επιτυχής σύνδεση");      
            localStorage.setItem("method", method); //send value to other page
            localStorage.setItem("account", account);
            window.location.href = "/homepage/"+method+"/"+account;
          }, 1);          
        }).
        fail(function(){
          clearfield();
          alert("Παρακαλώ όπως προσθέσετε τα σωστά στοιχεία. Τα στοιχεία σύνδεσης ή ο κωδικός πρόσβασης είναι λανθασμένος.");
        })
        ;
        event.preventDefault();
      });
    });

    function clearfield(){
      document.getElementById('identification').focus();
      document.getElementById('identification').value = "";
      document.getElementById('password').value = "";     
    }

    function isNumber(evt) {
      var x  = $("#identification_method").val();                
      evt = (evt) ? evt : window.event;
      var charCode = (evt.which) ? evt.which : evt.keyCode;
      if (x==='Τηλέφωνο Επικοινωνίας'){
        if ( (charCode > 31 && charCode < 48) || charCode > 57) {
          alert("Το πεδίο αυτό δέχεται μόνο αριθμούς");
          return false;
        }        
      }
      return true;
    }
  </script>
  {% endblock %}
</head>
<body>
  <!-- For creating spin loading
    https://www.geeksforgeeks.org/how-to-show-page-loading-div-until-the-page-has-finished-loading/ 
  -->
  <!-- Navbar  -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <!-- <nav class="navbar navbar-expand-lg navbar-default bg-primary"> -->
    <ul class="navbar-nav ml-auto">
      {% block profile%}
      <li class="nav-item">
        <a class="nav-link" href="/">Σύνδεση</a>      
      </li>    
      <li class="nav-item">
        <a class="nav-link" href="signup">Εγγραφή</a>
      </li>
      {%endblock%}
    </ul>
  </nav>
  <!-- End navbar -->

  <!-- Title -->
  <div class="container">
    <center>
      {% block title%}
      <h2>Καλωσορίσατε</h2>
      {%endblock%}
    </center>
  </div>
  <!-- End title -->

  <!-- Center home  -->
  <div class="container">
    <div class="row align-items-center justify-content-center">
      {% block content%}
      <div class="col-md-6">          
        <form  action="" method="post" role="form" id="fm">                    
          <div class="form-group">                   
            <label for="password">Σύνδεση</label>
            <select id="identification_method" name="identification_method" class="form-control" onchange="clearfield()" >
              <option id="identification_method" name="identification_method" value="Ταυτότητα" selected>Ταυτότητα</option>
              <option id="identification_method" name="identification_method" value="Τηλέφωνο Επικοινωνίας">Τηλέφωνο Επικοινωνίας</option>      
              <option id="identification_method" name="identification_method" value="Ηλεκτρονικό Ταχυδρομείο">Ηλεκτρονικό Ταχυδρομείο</option>
            </select><br>
            <input type="text" class="form-control" id="identification" name="identification" onkeypress="return isNumber(event)" placeholder="Καταχωρήστε τα στοιχεία σύνδεσης">
            <br>
            <label for="password">Κωδικός Πρόσβασης:</label>
            <input type="password" class="form-control" id="password" name="password" placeholder="Εισαγωγή κωδικού">
          </div>
          <br>                             
          <center>
            <button type="submit" id="submit" class="btn btn-success" data-loading-text="Loading...">Σύνδεση</button>
          </center>
        </form>        
        <p> Δεν έχεις λογαριασμό; <a href="signup">Δημιούργησε τώρα!</a> </p> 
      </div>
      <br>        
      {% endblock%}
    </div>
  </div>
  <!-- End center home-->

  <!-- Blocks for other pages  -->
  {% block map %}
  {% endblock%}
  {% block pharmacies %}
  {% endblock%}

  {% block hidden %}
  {%endblock%}
  <!-- End blocks  -->

<div class="loader"></div>


  <!-- Footer -->
  <footer class="page-footer font-small blue">        
    <div class="footer-copyright text-center py-3">© 2020 Copyright:
      <a href="https://mdbootstrap.com/"> MDBootstrap.com</a>
    </div>        
  </footer>      
  <!-- End footer -->
</body>
</html>